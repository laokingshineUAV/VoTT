{"ast":null,"code":"import _regeneratorRuntime from \"/home/jw/Documents/code/VoTT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/jw/Documents/code/VoTT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/jw/Documents/code/VoTT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/jw/Documents/code/VoTT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport axios from \"axios\";\nimport { AssetType } from \"../../models/applicationState\";\nimport { AssetService } from \"../../services/assetService\";\nimport Guard from \"../../common/guard\";\nimport { createQueryString } from \"../../common/utils\";\n/**\n * Options for Bing Image Search\n * @member apiKey - Bing Search API Key (Cognitive Services)\n * @member query - Query for Bing Search\n * @member aspectRatio - Aspect Ratio for desired images\n */\n\n/**\n * Aspect Ratio for Bing Image Search\n */\nexport var BingImageSearchAspectRatio;\n/**\n * Asset Provider for Bing Image Search\n */\n\n(function (BingImageSearchAspectRatio) {\n  BingImageSearchAspectRatio[\"Square\"] = \"Square\";\n  BingImageSearchAspectRatio[\"Wide\"] = \"Wide\";\n  BingImageSearchAspectRatio[\"Tall\"] = \"Tall\";\n  BingImageSearchAspectRatio[\"All\"] = \"All\";\n})(BingImageSearchAspectRatio || (BingImageSearchAspectRatio = {}));\n\nexport var BingImageSearch =\n/*#__PURE__*/\nfunction () {\n  function BingImageSearch(options) {\n    _classCallCheck(this, BingImageSearch);\n\n    this.options = options;\n    Guard.null(options);\n  }\n  /**\n   * Retrieves assets from Bing Image Search based on options provided\n   */\n\n\n  _createClass(BingImageSearch, [{\n    key: \"getAssets\",\n    value: function () {\n      var _getAssets = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var query, url, response, items;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                query = {\n                  q: this.options.query,\n                  aspect: this.options.aspectRatio\n                };\n                url = \"\".concat(BingImageSearch.SEARCH_URL, \"?\").concat(createQueryString(query));\n                _context.next = 4;\n                return axios.get(url, {\n                  headers: {\n                    \"Ocp-Apim-Subscription-Key\": this.options.apiKey,\n                    \"Accept\": \"application/json\"\n                  }\n                });\n\n              case 4:\n                response = _context.sent;\n                items = response.data.value.map(function (item) {\n                  return item.contentUrl;\n                });\n                return _context.abrupt(\"return\", items.map(function (filePath) {\n                  return AssetService.createAssetFromFilePath(filePath);\n                }).filter(function (asset) {\n                  return asset.type !== AssetType.Unknown;\n                }));\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getAssets() {\n        return _getAssets.apply(this, arguments);\n      }\n\n      return getAssets;\n    }()\n  }]);\n\n  return BingImageSearch;\n}();\nBingImageSearch.SEARCH_URL = \"https://api.cognitive.microsoft.com/bing/v7.0/images/search\";","map":{"version":3,"sources":["/home/jw/Documents/code/VoTT/src/providers/storage/bingImageSearch.ts"],"names":["axios","AssetType","AssetService","Guard","createQueryString","BingImageSearchAspectRatio","BingImageSearch","options","null","query","q","aspect","aspectRatio","url","SEARCH_URL","get","headers","apiKey","response","items","data","value","map","item","contentUrl","filePath","createAssetFromFilePath","filter","asset","type","Unknown"],"mappings":";;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAiBC,SAAjB,QAAkC,+BAAlC;AAEA,SAASC,YAAT,QAA6B,6BAA7B;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,SAASC,iBAAT,QAAkC,oBAAlC;AAEA;;;;;;;AAYA;;;AAGA,WAAYC,0BAAZ;AAOA;;;;WAPYA,0B;AAAAA,EAAAA,0B;AAAAA,EAAAA,0B;AAAAA,EAAAA,0B;AAAAA,EAAAA,0B;GAAAA,0B,KAAAA,0B;;AAUZ,WAAaC,eAAb;AAAA;AAAA;AAGI,2BAAoBC,OAApB,EAAsD;AAAA;;AAAA;AAClDJ,IAAAA,KAAK,CAACK,IAAN,CAAWD,OAAX;AACH;AAED;;;;;AAPJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWcE,gBAAAA,KAXd,GAWsB;AACVC,kBAAAA,CAAC,EAAE,KAAKH,OAAL,CAAaE,KADN;AAEVE,kBAAAA,MAAM,EAAE,KAAKJ,OAAL,CAAaK;AAFX,iBAXtB;AAgBcC,gBAAAA,GAhBd,aAgBuBP,eAAe,CAACQ,UAhBvC,cAgBqDV,iBAAiB,CAACK,KAAD,CAhBtE;AAAA;AAAA,uBAkB+BT,KAAK,CAACe,GAAN,CAAUF,GAAV,EAAe;AAClCG,kBAAAA,OAAO,EAAE;AACL,iDAA6B,KAAKT,OAAL,CAAaU,MADrC;AAEL,8BAAU;AAFL;AADyB,iBAAf,CAlB/B;;AAAA;AAkBcC,gBAAAA,QAlBd;AAyBcC,gBAAAA,KAzBd,GAyBsBD,QAAQ,CAACE,IAAT,CAAcC,KAAd,CAAoBC,GAApB,CAAwB,UAACC,IAAD;AAAA,yBAAUA,IAAI,CAACC,UAAf;AAAA,iBAAxB,CAzBtB;AAAA,iDA2BeL,KAAK,CACPG,GADE,CACE,UAACG,QAAD;AAAA,yBAAcvB,YAAY,CAACwB,uBAAb,CAAqCD,QAArC,CAAd;AAAA,iBADF,EAEFE,MAFE,CAEK,UAACC,KAAD;AAAA,yBAAWA,KAAK,CAACC,IAAN,KAAe5B,SAAS,CAAC6B,OAApC;AAAA,iBAFL,CA3Bf;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAaxB,e,CACMQ,U,GAAa,6D","sourcesContent":["import axios from \"axios\";\nimport { IAsset, AssetType } from \"../../models/applicationState\";\nimport { IAssetProvider } from \"./assetProviderFactory\";\nimport { AssetService } from \"../../services/assetService\";\nimport Guard from \"../../common/guard\";\nimport { createQueryString } from \"../../common/utils\";\n\n/**\n * Options for Bing Image Search\n * @member apiKey - Bing Search API Key (Cognitive Services)\n * @member query - Query for Bing Search\n * @member aspectRatio - Aspect Ratio for desired images\n */\nexport interface IBingImageSearchOptions {\n    apiKey: string;\n    query: string;\n    aspectRatio: BingImageSearchAspectRatio;\n}\n\n/**\n * Aspect Ratio for Bing Image Search\n */\nexport enum BingImageSearchAspectRatio {\n    Square = \"Square\",\n    Wide = \"Wide\",\n    Tall = \"Tall\",\n    All = \"All\",\n}\n\n/**\n * Asset Provider for Bing Image Search\n */\nexport class BingImageSearch implements IAssetProvider {\n    private static SEARCH_URL = \"https://api.cognitive.microsoft.com/bing/v7.0/images/search\";\n\n    constructor(private options: IBingImageSearchOptions) {\n        Guard.null(options);\n    }\n\n    /**\n     * Retrieves assets from Bing Image Search based on options provided\n     */\n    public async getAssets(): Promise<IAsset[]> {\n        const query = {\n            q: this.options.query,\n            aspect: this.options.aspectRatio,\n        };\n\n        const url = `${BingImageSearch.SEARCH_URL}?${createQueryString(query)}`;\n\n        const response = await axios.get(url, {\n            headers: {\n                \"Ocp-Apim-Subscription-Key\": this.options.apiKey,\n                \"Accept\": \"application/json\",\n            },\n        });\n\n        const items = response.data.value.map((item) => item.contentUrl);\n\n        return items\n            .map((filePath) => AssetService.createAssetFromFilePath(filePath))\n            .filter((asset) => asset.type !== AssetType.Unknown);\n    }\n}\n"]},"metadata":{},"sourceType":"module"}