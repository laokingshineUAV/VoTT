/*!
 * Application Insights JavaScript SDK - Web Analytics, 2.0.0-beta.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e.Microsoft=e.Microsoft||{},e.Microsoft.ApplicationInsights={}))}(this,function(e){"use strict";var i,t,d,n;(t=i||(i={}))[t.LocalStorage=0]="LocalStorage",t[t.SessionStorage=1]="SessionStorage",(n=d||(d={}))[n.Default=0]="Default",n[n.Required=1]="Required",n[n.Array=2]="Array",n[n.Hidden=4]="Hidden";var l,r,f=function(){function e(){}return e.isNullOrUndefined=function(e){return null==e},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},e}(),o=/[xy]/g;(r=l||(l={}))[r.CRITICAL=1]="CRITICAL",r[r.WARNING=2]="WARNING";var a=1,c=2,u=3,g=4,p=5,h=6,s=8,m=10,v=11,w=25,y=29,_=30,I=31,S=32,N=35,T=36,E=37,D=38,x=39,k=45,b=49,A=52,P=56,C=57,M=61,R=62,L=63,U=64,z=66,O=68,G=69,V=(function(){function e(){this.identifier="ChannelControllerPlugin",this.priority=V}e.prototype.processTelemetry=function(t){this.channelQueue.forEach(function(e){0<e.length&&e[0].processTelemetry(t)})},Object.defineProperty(e.prototype,"ChannelControls",{get:function(){return this.channelQueue},enumerable:!0,configurable:!0}),e.prototype.initialize=function(n,r,i){var o=this;if(this.channelQueue=new Array,n.channels){var a=void 0;n.channels.forEach(function(e){if(e&&0<e.length){if((e=e.sort(function(e,t){return e.priority-t.priority})).forEach(function(e){e.priority<V&&(a=e.identifier),e.initialize(n,r,i)}),a)throw Error(q+a);for(var t=1;t<e.length;t++)e[t-1].setNextPlugin(e[t]);o.channelQueue.push(e)}})}for(var e=new Array,t=0;t<i.length;t++){var s=i[t];s.priority>V&&e.push(s)}if(0<e.length){(e=e.sort(function(e,t){return e.priority-t.priority})).forEach(function(e){return e.initialize(n,r,i)});for(t=1;t<e.length;t++)e[t-1].setNextPlugin(e[t]);this.channelQueue.push(e)}}}(),500),q="Channel has invalid priority",j=function(){function s(){}return s.sanitizeKeyAndAddUniqueness=function(e,t,n){var r=t.length,i=s.sanitizeKey(e,t);if(i.length!==r){for(var o=0,a=i;void 0!==n[a];)o++,a=i.substring(0,s.MAX_NAME_LENGTH-3)+s.padNumber(o);i=a}return i},s.sanitizeKey=function(e,t){return t&&(t=s.trim(t.toString())).length>s.MAX_NAME_LENGTH&&(t=t.substring(0,s.MAX_NAME_LENGTH),e.throwInternal(l.WARNING,C,"name is too long.  It has been truncated to "+s.MAX_NAME_LENGTH+" characters.",{name:t},!0)),t},s.sanitizeString=function(e,t,n){return void 0===n&&(n=s.MAX_STRING_LENGTH),t&&(n=n||s.MAX_STRING_LENGTH,(t=s.trim(t)).toString().length>n&&(t=t.toString().substring(0,n),e.throwInternal(l.WARNING,M,"string value is too long. It has been truncated to "+n+" characters.",{value:t},!0))),t},s.sanitizeUrl=function(e,t){return s.sanitizeInput(e,t,s.MAX_URL_LENGTH,z)},s.sanitizeMessage=function(e,t){return t&&t.length>s.MAX_MESSAGE_LENGTH&&(t=t.substring(0,s.MAX_MESSAGE_LENGTH),e.throwInternal(l.WARNING,P,"message is too long, it has been truncated to "+s.MAX_MESSAGE_LENGTH+" characters.",{message:t},!0)),t},s.sanitizeException=function(e,t){return t&&t.length>s.MAX_EXCEPTION_LENGTH&&(t=t.substring(0,s.MAX_EXCEPTION_LENGTH),e.throwInternal(l.WARNING,A,"exception is too long, it has been truncated to "+s.MAX_EXCEPTION_LENGTH+" characters.",{exception:t},!0)),t},s.sanitizeProperties=function(t,e){if(e){var n={};for(var r in e){var i=e[r];if("object"==typeof i&&"undefined"!=typeof JSON)try{i=JSON.stringify(i)}catch(e){t.throwInternal(l.WARNING,b,"custom property is not valid",{exception:e},!0)}i=s.sanitizeString(t,i,s.MAX_PROPERTY_LENGTH),n[r=s.sanitizeKeyAndAddUniqueness(t,r,n)]=i}e=n}return e},s.sanitizeMeasurements=function(e,t){if(t){var n={};for(var r in t){var i=t[r];n[r=s.sanitizeKeyAndAddUniqueness(e,r,n)]=i}t=n}return t},s.sanitizeId=function(e,t){return t?s.sanitizeInput(e,t,s.MAX_ID_LENGTH,G).toString():t},s.sanitizeInput=function(e,t,n,r){return t&&(t=s.trim(t)).length>n&&(t=t.substring(0,n),e.throwInternal(l.WARNING,r,"input is too long, it has been truncated to "+n+" characters.",{data:t},!0)),t},s.padNumber=function(e){var t="00"+e;return t.substr(t.length-3)},s.trim=function(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")},s.MAX_NAME_LENGTH=150,s.MAX_ID_LENGTH=128,s.MAX_PROPERTY_LENGTH=8192,s.MAX_STRING_LENGTH=1024,s.MAX_URL_LENGTH=2048,s.MAX_MESSAGE_LENGTH=32768,s.MAX_EXCEPTION_LENGTH=32768,s}(),B=function(){function s(){}return s.disableStorage=function(){s._canUseLocalStorage=!1,s._canUseSessionStorage=!1},s._getLocalStorageObject=function(){return s.canUseLocalStorage()?s._getVerifiedStorageObject(i.LocalStorage):null},s._getVerifiedStorageObject=function(e){var t,n,r=null;try{if("undefined"==typeof window)return null;n=new Date,(r=e===i.LocalStorage?window.localStorage:window.sessionStorage).setItem(n,n),t=r.getItem(n)!=n,r.removeItem(n),t&&(r=null)}catch(e){r=null}return r},s.isInternalApplicationInsightsEndpoint=function(e){return-1!==s._internalEndpoints.indexOf(e.toLowerCase())},s.canUseLocalStorage=function(){return void 0===s._canUseLocalStorage&&(s._canUseLocalStorage=!!s._getVerifiedStorageObject(i.LocalStorage)),s._canUseLocalStorage},s.getStorage=function(t,e){var n=s._getLocalStorageObject();if(null!==n)try{return n.getItem(e)}catch(e){s._canUseLocalStorage=!1,t.throwInternal(l.WARNING,a,"Browser failed read of local storage. "+s.getExceptionName(e),{exception:s.dump(e)})}return null},s.setStorage=function(t,e,n){var r=s._getLocalStorageObject();if(null!==r)try{return r.setItem(e,n),!0}catch(e){s._canUseLocalStorage=!1,t.throwInternal(l.WARNING,u,"Browser failed write to local storage. "+s.getExceptionName(e),{exception:s.dump(e)})}return!1},s.removeStorage=function(t,e){var n=s._getLocalStorageObject();if(null!==n)try{return n.removeItem(e),!0}catch(e){s._canUseLocalStorage=!1,t.throwInternal(l.WARNING,p,"Browser failed removal of local storage item. "+s.getExceptionName(e),{exception:s.dump(e)})}return!1},s._getSessionStorageObject=function(){return s.canUseSessionStorage()?s._getVerifiedStorageObject(i.SessionStorage):null},s.canUseSessionStorage=function(){return void 0===s._canUseSessionStorage&&(s._canUseSessionStorage=!!s._getVerifiedStorageObject(i.SessionStorage)),s._canUseSessionStorage},s.getSessionStorageKeys=function(){var e=[];if(s.canUseSessionStorage())for(var t in window.sessionStorage)e.push(t);return e},s.getSessionStorage=function(t,e){var n=s._getSessionStorageObject();if(null!==n)try{return n.getItem(e)}catch(e){s._canUseSessionStorage=!1,t.throwInternal(l.WARNING,c,"Browser failed read of session storage. "+s.getExceptionName(e),{exception:s.dump(e)})}return null},s.setSessionStorage=function(t,e,n){var r=s._getSessionStorageObject();if(null!==r)try{return r.setItem(e,n),!0}catch(e){s._canUseSessionStorage=!1,t.throwInternal(l.WARNING,g,"Browser failed write to session storage. "+s.getExceptionName(e),{exception:s.dump(e)})}return!1},s.removeSessionStorage=function(t,e){var n=s._getSessionStorageObject();if(null!==n)try{return n.removeItem(e),!0}catch(e){s._canUseSessionStorage=!1,t.throwInternal(l.WARNING,h,"Browser failed removal of session storage item. "+s.getExceptionName(e),{exception:s.dump(e)})}return!1},s.disableCookies=function(){s._canUseCookies=!1},s.canUseCookies=function(t){if(void 0===s._canUseCookies){s._canUseCookies=!1;try{s._canUseCookies=void 0!==s.document.cookie}catch(e){t.throwInternal(l.WARNING,O,"Cannot access document.cookie - "+s.getExceptionName(e),{exception:s.dump(e)})}}return s._canUseCookies},s.setCookie=function(e,t,n,r){var i="",o="";r&&(i=";domain="+r),s.document.location&&"https:"===s.document.location.protocol&&(o=";secure"),s.canUseCookies(e)&&(s.document.cookie=t+"="+n+i+";path=/"+o)},s.stringToBoolOrDefault=function(e,t){return void 0===t&&(t=!1),null==e?t:"true"===e.toString().toLowerCase()},s.getCookie=function(e,t){if(s.canUseCookies(e)){var n="";if(t&&t.length)for(var r=t+"=",i=s.document.cookie.split(";"),o=0;o<i.length;o++){var a=i[o];if((a=s.trim(a))&&0===a.indexOf(r)){n=a.substring(r.length,i[o].length);break}}return n}},s.deleteCookie=function(e,t){s.canUseCookies(e)&&(s.document.cookie=t+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},s.trim=function(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")},s.newId=function(){for(var e="",t=1073741824*Math.random();0<t;){e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t%64),t=Math.floor(t/64)}return e},s.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},s.isError=function(e){return"[object Error]"===Object.prototype.toString.call(e)},s.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},s.toISOStringForIE8=function(e){if(s.isDate(e)){if(Date.prototype.toISOString)return e.toISOString();var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},s.getIEVersion=function(e){void 0===e&&(e=null);var t=e?e.toLowerCase():navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")?parseInt(t.split("msie")[1]):null},s.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,n=""+Math.floor(e/1e3)%60,r=""+Math.floor(e/6e4)%60,i=""+Math.floor(e/36e5)%24,o=Math.floor(e/864e5);return t=1===t.length?"00"+t:2===t.length?"0"+t:t,n=n.length<2?"0"+n:n,r=r.length<2?"0"+r:r,(0<o?o+".":"")+(i=i.length<2?"0"+i:i)+":"+r+":"+n+"."+t},s.isCrossOriginError=function(e,t,n,r,i){return("Script error."===e||"Script error"===e)&&!i},s.dump=function(e){var t=Object.prototype.toString.call(e),n=JSON.stringify(e);return"[object Error]"===t&&(n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'"),t+n},s.getExceptionName=function(e){return"[object Error]"===Object.prototype.toString.call(e)?e.name:""},s.addEventHandler=function(e,t){if("undefined"==typeof window||!window||"string"!=typeof e||"function"!=typeof t)return!1;var n="on"+e;if(window.addEventListener)window.addEventListener(e,t,!1);else{if(!window.attachEvent)return!1;window.attachEvent(n,t)}return!0},s.IsBeaconApiSupported=function(){return"sendBeacon"in navigator&&navigator.sendBeacon},s.document="undefined"!=typeof document?document:{},s._canUseCookies=void 0,s._canUseLocalStorage=void 0,s._canUseSessionStorage=void 0,s._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],s.NotSpecified="not_specified",s}(),X=function(){function r(){}return r.parseUrl=function(e){return r.htmlAnchorElement||(r.htmlAnchorElement=r.document.createElement?r.document.createElement("a"):{}),r.htmlAnchorElement.href=e,r.htmlAnchorElement},r.getAbsoluteUrl=function(e){var t,n=r.parseUrl(e);return n&&(t=n.href),t},r.getPathName=function(e){var t,n=r.parseUrl(e);return n&&(t=n.pathname),t},r.getCompleteUrl=function(e,t){return e?e.toUpperCase()+" "+t:t},r.document="undefined"!=typeof document?document:{},r}(),H=function(){function e(){}return e.ParseDependencyPath=function(e,t,n,r){var i,o=r,a=r;if(t&&0<t.length){var s=X.parseUrl(t);if(i=s.host,!o)if(null!=s.pathname){var c=0===s.pathname.length?"/":s.pathname;"/"!==c.charAt(0)&&(c="/"+c),a=s.pathname,o=j.sanitizeString(e,n?n+" "+c:c)}else o=j.sanitizeString(e,t)}else o=i=r;return{target:i,name:o,data:a}},e}(),W=function(){function e(){}return e.Now="undefined"==typeof window?function(){return(new Date).getTime()}:window.performance&&window.performance.now&&window.performance.timing?function(){return window.performance.now()+window.performance.timing.navigationStart}:function(){return(new Date).getTime()},e.GetDuration=function(e,t){var n=null;return 0===e||0===t||f.isNullOrUndefined(e)||f.isNullOrUndefined(t)||(n=t-e),n},e}(),K=function(e,t){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function F(e,t){function n(){this.constructor=e}K(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Q,J,Y=function(e){function t(){return e.call(this)||this}return F(t,e),t}(function(){}),$=(function(i){function e(e,t,n){var r=i.call(this)||this;return r.name=j.sanitizeString(e,n)||B.NotSpecified,r.data=t,r.time=B.toISOStringForIE8(new Date),r.aiDataContract={time:d.Required,iKey:d.Required,name:d.Required,sampleRate:function(){return 100==r.sampleRate?d.Hidden:d.Required},tags:d.Required,data:d.Required},r}F(e,i)}(function(){this.ver=1,this.sampleRate=100,this.tags={}}),function(){}),Z=function(t){function e(){var e=t.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}return F(e,t),e}($),ee=function(o){function e(e,t,n,r){var i=o.call(this)||this;return i.aiDataContract={ver:d.Required,name:d.Required,properties:d.Default,measurements:d.Default},i.name=j.sanitizeString(e,t)||B.NotSpecified,i.properties=j.sanitizeProperties(e,n),i.measurements=j.sanitizeMeasurements(e,r),i}return F(e,o),e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}(Z),te=function(){},ne=function(){this.hasFullStack=!0,this.parsedStack=[]},re=function(a){function e(e,t,n,r,i){var o=a.call(this)||this;return o.aiDataContract={ver:d.Required,exceptions:d.Required,severityLevel:d.Default,properties:d.Default,measurements:d.Default},o.properties=j.sanitizeProperties(e,n),o.measurements=j.sanitizeMeasurements(e,r),o.exceptions=[new ie(e,t)],i&&(o.severityLevel=i),o}return F(e,a),e.CreateSimpleException=function(e,t,n,r,i,o){return{exceptions:[{hasFullStack:!0,message:e,stack:i,typeName:t}]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e}(function(t){function e(){var e=t.call(this)||this;return e.ver=2,e.exceptions=[],e.properties={},e.measurements={},e}return F(e,t),e}($)),ie=function(i){function e(e,t){var n=i.call(this)||this;n.aiDataContract={id:d.Default,outerId:d.Default,typeName:d.Required,message:d.Required,hasFullStack:d.Default,stack:d.Default,parsedStack:d.Array},n.typeName=j.sanitizeString(e,t.name)||B.NotSpecified,n.message=j.sanitizeMessage(e,t.message)||B.NotSpecified;var r=t.stack;return n.parsedStack=n.parseStack(r),n.stack=j.sanitizeException(e,r),n.hasFullStack=B.isArray(n.parsedStack)&&0<n.parsedStack.length,n}return F(e,i),e.prototype.parseStack=function(e){var t=void 0;if("string"==typeof e){var n=e.split("\n");t=[];for(var r=0,i=0,o=0;o<=n.length;o++){var a=n[o];if(oe.regex.test(a)){var s=new oe(n[o],r++);i+=s.sizeInBytes,t.push(s)}}if(32768<i)for(var c=0,u=t.length-1,l=0,f=c,g=u;c<u;){if(32768<(l+=t[c].sizeInBytes+t[u].sizeInBytes)){var p=g-f+1;t.splice(f,p);break}f=c,g=u,c++,u--}}return t},e}(ne),oe=function(i){function o(e,t){var n=i.call(this)||this;n.sizeInBytes=0,n.aiDataContract={level:d.Required,method:d.Required,assembly:d.Default,fileName:d.Default,line:d.Default},n.level=t,n.method="<no_method>",n.assembly=B.trim(e);var r=e.match(o.regex);return r&&5<=r.length&&(n.method=B.trim(r[2])||n.method,n.fileName=B.trim(r[4]),n.line=parseInt(r[5])||0),n.sizeInBytes+=n.method.length,n.sizeInBytes+=n.fileName.length,n.sizeInBytes+=n.assembly.length,n.sizeInBytes+=o.baseSize,n.sizeInBytes+=n.level.toString().length,n.sizeInBytes+=n.line.toString().length,n}return F(o,i),o.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,o.baseSize=58,o}(te),ae=function(t){function e(){var e=t.call(this)||this;return e.ver=2,e.metrics=[],e.properties={},e}return F(e,t),e}($);(J=Q||(Q={}))[J.Measurement=0]="Measurement",J[J.Aggregation=1]="Aggregation";var se,ce,ue=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aiDataContract={name:d.Required,kind:d.Default,value:d.Required,count:d.Default,min:d.Default,max:d.Default,stdDev:d.Default},e}return F(e,t),e}(function(){this.kind=Q.Measurement}),le=function(u){function e(e,t,n,r,i,o,a){var s=u.call(this)||this;s.aiDataContract={ver:d.Required,metrics:d.Required,properties:d.Default};var c=new ue;return c.count=0<r?r:void 0,c.max=isNaN(o)||null===o?void 0:o,c.min=isNaN(i)||null===i?void 0:i,c.name=j.sanitizeString(e,t)||B.NotSpecified,c.value=n,s.metrics=[c],s.properties=j.sanitizeProperties(e,a),s}return F(e,u),e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}(ae),fe=function(t){function e(){var e=t.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}return F(e,t),e}(Z),ge=function(c){function e(e,t,n,r,i,o,a){var s=c.call(this)||this;return s.aiDataContract={ver:d.Required,name:d.Default,url:d.Default,duration:d.Default,properties:d.Default,measurements:d.Default,id:d.Default},s.id=j.sanitizeId(e,a),s.url=j.sanitizeUrl(e,n),s.name=j.sanitizeString(e,t)||B.NotSpecified,isNaN(r)||(s.duration=B.msToTimeSpan(r)),s.properties=j.sanitizeProperties(e,i),s.measurements=j.sanitizeMeasurements(e,o),s}return F(e,c),e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}(fe),pe=function(p){function e(e,t,n,r,i,o,a,s,c,u,l){void 0===c&&(c="Ajax");var f=p.call(this)||this;f.aiDataContract={id:d.Required,ver:d.Required,name:d.Default,resultCode:d.Default,duration:d.Default,success:d.Default,data:d.Default,target:d.Default,type:d.Default,properties:d.Default,measurements:d.Default,kind:d.Default,value:d.Default,count:d.Default,min:d.Default,max:d.Default,stdDev:d.Default,dependencyKind:d.Default,dependencySource:d.Default,commandName:d.Default,dependencyTypeName:d.Default},f.id=t,f.duration=B.msToTimeSpan(i),f.success=o,f.resultCode=a+"",f.type=j.sanitizeString(e,c);var g=H.ParseDependencyPath(e,n,s,r);return f.data=j.sanitizeUrl(e,r)||g.data,f.target=g.target,f.name=g.name,f.properties=j.sanitizeProperties(e,u),f.measurements=j.sanitizeMeasurements(e,l),f}return F(e,p),e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}(function(t){function e(){var e=t.call(this)||this;return e.ver=2,e.success=!0,e.properties={},e.measurements={},e}return F(e,t),e}($)),de=function(o){function e(e,t,n,r){var i=o.call(this)||this;return i.aiDataContract={ver:d.Required,message:d.Required,severityLevel:d.Default,properties:d.Default},t=t||B.NotSpecified,i.message=j.sanitizeMessage(e,t),i.properties=j.sanitizeProperties(e,r),n&&(i.severityLevel=n),i}return F(e,o),e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}(function(t){function e(){var e=t.call(this)||this;return e.ver=2,e.properties={},e}return F(e,t),e}($)),he=function(s){function e(e,t,n,r,i,o){var a=s.call(this)||this;return a.aiDataContract={ver:d.Required,name:d.Default,url:d.Default,duration:d.Default,perfTotal:d.Default,networkConnect:d.Default,sentRequest:d.Default,receivedResponse:d.Default,domProcessing:d.Default,properties:d.Default,measurements:d.Default},a.url=j.sanitizeUrl(e,n),a.name=j.sanitizeString(e,t)||B.NotSpecified,a.properties=j.sanitizeProperties(e,i),a.measurements=j.sanitizeMeasurements(e,o),a}return F(e,s),e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}(function(t){function e(){var e=t.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}return F(e,t),e}(fe));!function(r){function e(e,t){var n=r.call(this)||this;return n.aiDataContract={baseType:d.Required,baseData:d.Required},n.baseType=e,n.baseData=t,n}F(e,r)}(Y);(ce=se||(se={}))[ce.Verbose=0]="Verbose",ce[ce.Information=1]="Information",ce[ce.Warning=2]="Warning",ce[ce.Error=3]="Error",ce[ce.Critical=4]="Critical";var me=function(){function e(){}return e.getConfig=function(e,t,n,r){var i;return void 0===r&&(r=!1),i=n&&e.extensionConfig&&e.extensionConfig[n]&&!f.isNullOrUndefined(e.extensionConfig[n][t])?e.extensionConfig[n][t]:e[t],f.isNullOrUndefined(i)?r:i},e}(),ve=function(){function e(){}return e.create=function(e,t,n,r,i,o){if(n=j.sanitizeString(r,n)||B.NotSpecified,f.isNullOrUndefined(e)||f.isNullOrUndefined(t)||f.isNullOrUndefined(n))throw Error("Input doesn't contain all required fields");var a={name:n,time:(new Date).toISOString(),iKey:"",ext:o||{},tags:[],data:{},baseType:t,baseData:e};if(!f.isNullOrUndefined(i))for(var s in i)i.hasOwnProperty(s)&&(a.data[s]=i[s]);return a},e}(),we=function(){function e(e,t,n,r){this.pageViewPerformanceSent=!1,this.overridePageViewDuration=!1,this.overridePageViewDuration=t,this.appInsights=e,this._pageViewPerformanceManager=r,n&&(this._channel=function(){return n.getTransmissionControls()},this._logger=n.logger)}return e.prototype.trackPageView=function(t,n){var r=this,i=t.name;(f.isNullOrUndefined(i)||"string"!=typeof i)&&(t.name=window.document&&window.document.title||"");var o=t.uri;if((f.isNullOrUndefined(o)||"string"!=typeof o)&&(t.uri=window.location&&window.location.href||""),!this._pageViewPerformanceManager.isPerformanceTimingSupported())return this.appInsights.sendPageViewInternal(t,n),this._channel().forEach(function(e){e.forEach(function(e){return e.flush(!0)})}),void this._logger.throwInternal(l.WARNING,w,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var a=!1,s=void 0,c=this._pageViewPerformanceManager.getPerformanceTiming().navigationStart;s=W.GetDuration(c,+new Date),this._pageViewPerformanceManager.shouldCollectDuration(s)||(s=void 0);var e=void 0;f.isNullOrUndefined(n)||f.isNullOrUndefined(n.duration)||(e=n.duration),!this.overridePageViewDuration&&isNaN(e)||(isNaN(e)&&(n||(n={}),n.duration=s),this.appInsights.sendPageViewInternal(t,n),this._channel().forEach(function(e){e.forEach(function(e){return e.flush(!0)})}),a=!0);n||(n={});var u=setInterval(function(){try{if(r._pageViewPerformanceManager.isPerformanceTimingDataReady()){clearInterval(u);var e={name:i,uri:o};r._pageViewPerformanceManager.populatePageViewPerformanceEvent(e),e.isValid||a?(a||(n.duration=e.durationMs,r.appInsights.sendPageViewInternal(t,n)),r.pageViewPerformanceSent||(r.appInsights.sendPageViewPerformanceInternal(e,n),r.pageViewPerformanceSent=!0),r._channel().forEach(function(e){e.forEach(function(e){return e.flush(!0)})})):(n.duration=s,r.appInsights.sendPageViewInternal(t,n),r._channel().forEach(function(e){e.forEach(function(e){return e.flush(!0)})}))}else 6e4<W.GetDuration(c,+new Date)&&(clearInterval(u),a||(n.duration=6e4,r.appInsights.sendPageViewInternal(t,n),r._channel().forEach(function(e){e.forEach(function(e){return e.flush(!0)})})))}catch(e){r._logger.throwInternal(l.CRITICAL,D,"trackPageView failed on page load calculation: "+B.getExceptionName(e),{exception:B.dump(e)})}},100)},e}(),ye=function(){function e(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return e.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var t=this.getPerformanceTiming();if(t){var n=W.GetDuration(t.navigationStart,t.loadEventEnd),r=W.GetDuration(t.navigationStart,t.connectEnd),i=W.GetDuration(t.requestStart,t.responseStart),o=W.GetDuration(t.responseStart,t.responseEnd),a=W.GetDuration(t.responseEnd,t.loadEventEnd);0==n?this._logger.throwInternal(l.WARNING,m,"error calculating page view performance.",{total:n,network:r,request:i,response:o,dom:a}):this.shouldCollectDuration(n,r,i,o,a)?n<Math.floor(r)+Math.floor(i)+Math.floor(o)+Math.floor(a)?this._logger.throwInternal(l.WARNING,s,"client performance math error.",{total:n,network:r,request:i,response:o,dom:a}):(e.durationMs=n,e.perfTotal=e.duration=B.msToTimeSpan(n),e.networkConnect=B.msToTimeSpan(r),e.sentRequest=B.msToTimeSpan(i),e.receivedResponse=B.msToTimeSpan(o),e.domProcessing=B.msToTimeSpan(a),e.isValid=!0):this._logger.throwInternal(l.WARNING,k,"Invalid page load duration value. Browser perf data won't be sent.",{total:n,network:r,request:i,response:o,dom:a})}},e.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?window.performance.timing:null},e.prototype.isPerformanceTimingSupported=function(){return"undefined"!=typeof window&&window.performance&&window.performance.timing},e.prototype.isPerformanceTimingDataReady=function(){var e=window.performance.timing;return 0<e.domainLookupStart&&0<e.navigationStart&&0<e.responseStart&&0<e.requestStart&&0<e.loadEventEnd&&0<e.responseEnd&&0<e.connectEnd&&0<e.domLoading},e.prototype.shouldCollectDuration=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=["googlebot","adsbot-google","apis-google","mediapartners-google"],r=navigator.userAgent,i=!1;if(r)for(var o=0;o<n.length;o++)i=i||-1!==r.toLowerCase().indexOf(n[o]);if(i)return!1;for(var a=0;a<e.length;a++)if(e[a]>=this.MAX_DURATION_ALLOWED)return!1;return!0},e}(),_e="duration",Ie=function(){function u(){this.identifier="ApplicationInsightsAnalytics",this.priority=160,this._isInitialized=!1,this._trackAjaxAttempts=0,this.initialize=this._initialize.bind(this)}return u.getDefaultConfig=function(e){return e||(e={}),e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.disableExceptionTracking=B.stringToBoolOrDefault(e.disableExceptionTracking),e.autoTrackPageVisitTime=B.stringToBoolOrDefault(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||100<=e.samplingPercentage)&&(e.samplingPercentage=100),e.isCookieUseDisabled=B.stringToBoolOrDefault(e.isCookieUseDisabled),e.isStorageUseDisabled=B.stringToBoolOrDefault(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=B.stringToBoolOrDefault(e.isBrowserLinkTrackingEnabled),e},u.prototype.processTelemetry=function(e){for(var t=!1,n=this._telemetryInitializers.length,r=0;r<n;++r){var i=this._telemetryInitializers[r];if(i)try{if(!1===i.apply(null,[e])){t=!0;break}}catch(e){this._logger.throwInternal(l.CRITICAL,U,"One of telemetry initializers failed, telemetry item will not be sent: "+B.getExceptionName(e),{exception:B.dump(e)},!0)}}t||f.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(e)},u.prototype.setNextPlugin=function(e){this._nextPlugin=e},u.prototype.trackEvent=function(e,t){try{var n=ve.create(e,ee.dataType,ee.envelopeType,this._logger,t);this._setTelemetryNameAndIKey(n),this.core.track(n)}catch(e){this._logger.throwInternal(l.WARNING,x,"trackTrace failed, trace will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.startTrackEvent=function(e){try{this._eventTracking.start(e)}catch(e){this._logger.throwInternal(l.CRITICAL,y,"startTrackEvent failed, event will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.stopTrackEvent=function(e,t,n){try{this._eventTracking.stop(e,void 0,t)}catch(e){this._logger.throwInternal(l.CRITICAL,_,"stopTrackEvent failed, event will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.trackTrace=function(e,t){try{var n=ve.create(e,de.dataType,de.envelopeType,this._logger,t);this._setTelemetryNameAndIKey(n),this.core.track(n)}catch(e){this._logger.throwInternal(l.WARNING,x,"trackTrace failed, trace will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.trackMetric=function(e,t){try{var n=ve.create(e,le.dataType,le.envelopeType,this._logger,t);this._setTelemetryNameAndIKey(n),this.core.track(n)}catch(e){this._logger.throwInternal(l.CRITICAL,T,"trackMetric failed, metric will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.trackPageView=function(e,t){try{this._pageViewManager.trackPageView(e,t),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(e.name,e.uri)}catch(e){this._logger.throwInternal(l.CRITICAL,E,"trackPageView failed, page view will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.sendPageViewInternal=function(e,t,n){"undefined"!=typeof document&&(e.refUri=e.refUri||document.referrer);var r=ve.create(e,ge.dataType,ge.envelopeType,this._logger,t,n);this._setTelemetryNameAndIKey(r),this.core.track(r),this._trackAjaxAttempts=0},u.prototype.sendPageViewPerformanceInternal=function(e,t,n){var r=ve.create(e,he.dataType,he.envelopeType,this._logger,t,n);this._setTelemetryNameAndIKey(r),this.core.track(r)},u.prototype.trackPageViewPerformance=function(e,t){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(e),this.sendPageViewPerformanceInternal(e,t)}catch(e){this._logger.throwInternal(l.CRITICAL,E,"trackPageViewPerformance failed, page view will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.startTrackPage=function(e){try{"string"!=typeof e&&(e=window.document&&window.document.title||""),this._pageTracking.start(e)}catch(e){this._logger.throwInternal(l.CRITICAL,I,"startTrackPage failed, page view may not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.stopTrackPage=function(e,t,n,r){try{"string"!=typeof e&&(e=window.document&&window.document.title||""),"string"!=typeof t&&(t=window.location&&window.location.href||""),this._pageTracking.stop(e,t,n,r),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(e,t)}catch(e){this._logger.throwInternal(l.CRITICAL,S,"stopTrackPage failed, page view will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype.sendExceptionInternal=function(e,t,n){var r=new re(this._logger,e.error,e.properties,e.measurements,e.severityLevel),i=ve.create(r,re.dataType,re.envelopeType,this._logger,t,n);this._setTelemetryNameAndIKey(i),this.core.track(i)},u.prototype.trackException=function(e,t){try{this.sendExceptionInternal(e,t)}catch(e){this._logger.throwInternal(l.CRITICAL,N,"trackException failed, exception will not be collected: "+B.getExceptionName(e),{exception:B.dump(e)})}},u.prototype._onerror=function(t){try{var e={url:t&&t.url||document.URL,lineNumber:t.lineNumber,columnNumber:t.columnNumber,message:t.message};if(B.isCrossOriginError(t.message,t.url,t.lineNumber,t.columnNumber,t.error))this._sendCORSException(e.url);else{if(!B.isError(t.error)){var n="window.onerror@"+e.url+":"+t.lineNumber+":"+(t.columnNumber||0);t.error=new Error(t.message),t.error.stack=n}this.trackException({error:t.error,severityLevel:se.Error},e)}}catch(e){var r=t.error?t.error.name+", "+t.error.message:"null";this._logger.throwInternal(l.CRITICAL,v,"_onError threw exception while logging error, error will not be collected: "+B.getExceptionName(e),{exception:B.dump(e),errorString:r})}},u.prototype.addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},u.prototype._initialize=function(e,t,n){var a=this;if(!this._isInitialized){if(f.isNullOrUndefined(t))throw Error("Error initializing");this.core=t,this._logger=t.logger,this._globalconfig={instrumentationKey:e.instrumentationKey,endpointUrl:e.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=e.extensionConfig&&e.extensionConfig[this.identifier]?e.extensionConfig[this.identifier]:{};var r=u.getDefaultConfig();if(void 0!==r){for(var i in r)this.config[i]=me.getConfig(e,i,this.identifier,r[i]);if(this._globalconfig)for(var i in r)void 0===this._globalconfig[i]&&(this._globalconfig[i]=r[i])}this.config.isCookieUseDisabled&&B.disableCookies(),this.config.isStorageUseDisabled&&B.disableStorage();var o={instrumentationKey:function(){return e.instrumentationKey},accountId:function(){return a.config.accountId||e.accountId},sessionRenewalMs:function(){return a.config.sessionRenewalMs||e.sessionRenewalMs},sessionExpirationMs:function(){return a.config.sessionExpirationMs||e.sessionExpirationMs},sampleRate:function(){return a.config.samplingPercentage||e.samplingPercentage},cookieDomain:function(){return a.config.cookieDomain||e.cookieDomain},sdkExtension:function(){return a.config.sdkExtension||e.sdkExtension},isBrowserLinkTrackingEnabled:function(){return a.config.isBrowserLinkTrackingEnabled||e.isBrowserLinkTrackingEnabled},appId:function(){return a.config.appId||e.appId}};if(this._pageViewPerformanceManager=new ye(this.core),this._pageViewManager=new we(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._telemetryInitializers=[],this._addDefaultTelemetryInitializers(o),this._eventTracking=new Se(this._logger,"trackEvent"),this._eventTracking.action=function(e,t,n,r){r||(r={}),r[_e]=n.toString(),a.trackEvent({name:e,properties:r})},this._pageTracking=new Se(this._logger,"trackPageView"),!(this._pageTracking.action=function(e,t,n,r,i){f.isNullOrUndefined(r)&&(r={}),r[_e]=n.toString();var o={name:e,uri:t,properties:r,measurements:i};a.sendPageViewInternal(o)})===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented){var s=window.onerror,c=this;window.onerror=function(e,t,n,r,i){var o=s&&s(e,t,n,r,i);return!0!==o&&c._onerror({message:e,url:t,lineNumber:n,columnNumber:r,error:i}),o},this.config.autoExceptionInstrumented=!0}this._isInitialized=!0}},u.prototype._addDefaultTelemetryInitializers=function(e){if(!e.isBrowserLinkTrackingEnabled()){var r=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer(function(e){if(e.baseType===pe.dataType){var t=e.baseData;if(t)for(var n=0;n<r.length;n++)if(t.target&&0<=t.target.indexOf(r[n]))return!1}return!0})}},u.prototype._addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},u.prototype._sendCORSException=function(e){var t={message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:e,lineNumber:0,columnNumber:0,error:void 0},n=ve.create(t,re.dataType,re.envelopeType,this._logger,{url:e});this.core.track(n)},u.prototype._setTelemetryNameAndIKey=function(e){e.iKey=this._globalconfig.instrumentationKey;var t=this._globalconfig.instrumentationKey.replace(/-/g,"");e.name=e.name.replace("{0}",t)},u.Version="2.0.0-beta.3",u}(),Se=function(){function e(e,t){this._name=t,this._events={},this._logger=e}return e.prototype.start=function(e){void 0!==this._events[e]&&this._logger.throwInternal(l.WARNING,R,"start was called more than once for this event without calling stop.",{name:this._name,key:e},!0),this._events[e]=+new Date},e.prototype.stop=function(e,t,n,r){var i=this._events[e];if(isNaN(i))this._logger.throwInternal(l.WARNING,L,"stop was called without a corresponding start.",{name:this._name,key:e},!0);else{var o=+new Date,a=W.GetDuration(i,o);this.action(e,t,a,n,r)}delete this._events[e],this._events[e]=void 0},e}();e.ApplicationInsights=Ie,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=applicationinsights-analytics-js.min.js.map
